I"<blockquote>
  <p>React.memo, React.lazy, suspense를 이용한 리액트 웹앱 성능 개선</p>
</blockquote>

<h2 id="memoization">memoization</h2>

<p>
&nbsp;memoization은 이전에 사용한 값을 저장해두고 동일한 계산 값에 대해 저장된 값을 사용하는 최적화 방법을 말한다. React에서는 useMemo, useCallback, React.memo를 이용해 memoization을 적용할 수 있다. useMemo는 값을, useCallback은 함수를 memoization하는 Hook이고, React.Memo는 컴포넌트를 memoization하는 HOC(high order component), 고차 컴포넌트다.
</p>
<p><br /></p>
<p>
&nbsp;React의 컴포넌트는 부모컴포넌트가 리렌더링될때, state, props가 변경될때 리렌더링 된다. 메인 페이지는 data state를 각 컴포넌트들에게 전달한다.
메인 페이지에서 특정 게시글의 하트를 누른다면 그 게시글 컴포넌트만 리렌더링이 되어야한다. 하지만 하트를 누르는 순간 부모컴포넌트의 state가 변경되고, 부모컴포넌트가 리렌더링되어서 하위 컴포넌트들도 모두 리렌더링된다. 이를 해결하기 위해 useCallback과 React.memo를 사용했다.
</p>
<p><br /></p>
<pre><code>// 렌더링될때마다 useNavigate()의 값이 달라져서 useCallback을 이용해 memoization하였다.

    const onSelectAdditionalTown = useCallback(() =&gt; {
    navigate('/town/regist');
    }, [navigate]);

</code></pre>
<p><br /></p>

<p>&nbsp;부모와 자식 컴포넌트를 분리하고 자식 컴포넌트에 React.memo를 이용했다.</p>
<pre><code>// React.memo는 객체를 얕은 비교한다. 
// 하트 값이 달라진 것만 비교하기 위해 두번째 인자로 비교함수 areEqual을 사용했다.

    // 하트 변경되지 않으면 리렌더링 되지 않게
    function areEqual(prevProps, nextProps) {
    if (
        prevProps.itemId === nextProps.itemId &amp;&amp;
        prevProps.itemsHeartCount === nextProps.itemsHeartCount
    ) {
        return true;
    }
    return false;
    }

    // 자식 컴포넌트
    const MainItems = React.memo(function MainItems({
        ...props들
        }){
            return(
                ...컴포넌트 요소
            )
        }, areEqual);

    export default MainItems;

</code></pre>
<p><br /></p>

<p>&nbsp;memoization 결과 게시글의 하트를 누르면 하트를 눌러 하트 개수가 변한 컴포넌트만 리렌더링 되었다.</p>
<p>그 밖에도 signup, create 페이지를 같은 식으로 memoization하였다. react의 profile을 이용해 성능을 체크해보았다.</p>

<p><img src="./../images/9-5-react-optimize/create_before.png" alt="create_before" />
<img src="./../images/9-5-react-optimize/create_after.png" alt="create_after" />
<img src="./../images/9-5-react-optimize/signup_before.png" alt="signup_before" />
<img src="./../images/9-5-react-optimize/signup_after.png" alt="signup_after" /></p>
:ET